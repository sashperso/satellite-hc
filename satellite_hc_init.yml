  #---
- name: Initialise the Satellite Health Check
  hosts: satellite
  roles:
    - high_level_check
    - disk_space_check
    - system_reqs_check
    - satellite_version_check
    - organisations_check
    - firewall_and_proxy_check
    - infrastructure_design_check
    - network_connectivity_check
    - qpidd_storage_check
    - logging_check
    - remote_execution_check
#    - errata_check
    - registered_host_check
    - compute_resources_check

  vars: 
    - satellite_server: <insert_satellite_url_here>

# NOTE TO SELF: MAYBE DO PACKAGE CHECK?
#  - i.e. sysstat

  tasks:
#    - name: Generate the Satellite Health Check Report in .txt format
#      ansible.builtin.template:
#        src: ./templates/satellite_hc_report.j2
#        dest: satellite_hc_report_{{ ansible_hostname }}.txt

    - name: Generate the Satellite Health Check Report in .adoc format
      ansible.builtin.template:
        src: ./templates/satellite_hc_report.adoc
        dest: satellite_hc_report_{{ ansible_hostname }}.adoc

#    - name: Fetch the .txt Satellite report and copy it to the local machine
#      ansible.builtin.fetch:
#        src: satellite_hc_report_{{ ansible_hostname }}.txt
#        dest: ./
#        flat: yes

    - name: Fetch the .adoc Satellite report and copy it to the local machine
      ansible.builtin.fetch:
        src: satellite_hc_report_{{ ansible_hostname }}.adoc
        dest: ./
        flat: yes

# note to self: make sure to use -u root then --ask-pass
